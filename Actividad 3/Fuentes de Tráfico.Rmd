---
title: "Fuentes de Tráfico"
author: "Natalia Clivio"
date: "2016"
output: word_document
---


#Caracterización fuente de datos

````{r echo=FALSE}
#Incoming=Downstream

traza1<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/5039556D06A0.csv",
               header=TRUE,sep=",",na.strings="NA",dec=".")
traza2<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0011AEA17B96.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza3<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001BD70A67A8.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza4<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/386BBBDE3EF4.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza5<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/7CBFB1B96514.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza6<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0011E659D0FD.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza7<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/34BDFA8C66F3.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza8<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0023BED75BEA.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza9<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001BD7A7BDE4.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")

traza10<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001BD7BBF6CA.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza11<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/00159A6160B0.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza12<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/CC7D37981A49.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza13<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0014E8295DC2.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza14<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001ADE631B8A.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza15<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0023BED18526.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza16<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/145BD1FD79DD.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza17<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001BD70A514A.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza18<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0025F2BD04AD.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza19<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001BD710FADC.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")

traza20<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/94CCB91B032C.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza21<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/088039A22100.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza22<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/0022CE977359.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza23<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001ADE98D58A.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza24<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/386BBB15666A.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza25<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/001CEA64E4AC.csv",
                 header=TRUE,sep=",",na.strings="NA",dec=".")
traza26<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/00223AEEC591.csv",
                  header=TRUE,sep=",",na.strings="NA",dec=".")
traza27<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/503955693D40.csv",
                  header=TRUE,sep=",",na.strings="NA",dec=".")
traza28<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/5039556995F6.csv",
                  header=TRUE,sep=",",na.strings="NA",dec=".")
traza29<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/34BDFA8A9080.csv",
                  header=TRUE,sep=",",na.strings="NA",dec=".")
traza30<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/6 Mbps Res/6455B1495979.csv",
                  header=TRUE,sep=",",na.strings="NA",dec=".")
````


Una vez, cargadas las trazas de cada suscriptor se calculan los parámetros de cada traza. Estos parámetros son:
Capacidad del canal **C** que esta determinada por la velocidad contratada por el adonado, para este caso son 6 Mbps.
***Tamaño de buffer **B**
Taza promedio de arribo $\hat{\mu}$
Varianza de la taza de arribo $\hat{\theta^2}$
parámetro Hurst **H**
Parámetro temporal **t**
Parámetro espacial **s**

````{r}
C<-6  #Capacidad del canal Mbps
H<-0.8

````


Calculando la tasa promedio de arribo de cada traza:
````{r}
for (i in 1:30) {
  cat("u",i,"<-","mean(traza",i,"$Total.Incoming.bps/1000000, na.rm = TRUE)","\n",sep = "")
}
````


````{r echo=FALSE}
u1<-mean(traza1$Total.Incoming.bps/1000000, na.rm = TRUE)
u2<-mean(traza2$Total.Incoming.bps/1000000, na.rm = TRUE)
u3<-mean(traza3$Total.Incoming.bps/1000000, na.rm = TRUE)
u4<-mean(traza4$Total.Incoming.bps/1000000, na.rm = TRUE)
u5<-mean(traza5$Total.Incoming.bps/1000000, na.rm = TRUE)
u6<-mean(traza6$Total.Incoming.bps/1000000, na.rm = TRUE)
u7<-mean(traza7$Total.Incoming.bps/1000000, na.rm = TRUE)
u8<-mean(traza8$Total.Incoming.bps/1000000, na.rm = TRUE)
u9<-mean(traza9$Total.Incoming.bps/1000000, na.rm = TRUE)
u10<-mean(traza10$Total.Incoming.bps/1000000, na.rm = TRUE)
u11<-mean(traza11$Total.Incoming.bps/1000000, na.rm = TRUE)
u12<-mean(traza12$Total.Incoming.bps/1000000, na.rm = TRUE)
u13<-mean(traza13$Total.Incoming.bps/1000000, na.rm = TRUE)
u14<-mean(traza14$Total.Incoming.bps/1000000, na.rm = TRUE)
u15<-mean(traza15$Total.Incoming.bps/1000000, na.rm = TRUE)
u16<-mean(traza16$Total.Incoming.bps/1000000, na.rm = TRUE)
u17<-mean(traza17$Total.Incoming.bps/1000000, na.rm = TRUE)
u18<-mean(traza18$Total.Incoming.bps/1000000, na.rm = TRUE)
u19<-mean(traza19$Total.Incoming.bps/1000000, na.rm = TRUE)
u20<-mean(traza20$Total.Incoming.bps/1000000, na.rm = TRUE)
u21<-mean(traza21$Total.Incoming.bps/1000000, na.rm = TRUE)
u22<-mean(traza22$Total.Incoming.bps/1000000, na.rm = TRUE)
u23<-mean(traza23$Total.Incoming.bps/1000000, na.rm = TRUE)
u24<-mean(traza24$Total.Incoming.bps/1000000, na.rm = TRUE)
u25<-mean(traza25$Total.Incoming.bps/1000000, na.rm = TRUE)
u26<-mean(traza26$Total.Incoming.bps/1000000, na.rm = TRUE)
u27<-mean(traza27$Total.Incoming.bps/1000000, na.rm = TRUE)
u28<-mean(traza28$Total.Incoming.bps/1000000, na.rm = TRUE)
u29<-mean(traza29$Total.Incoming.bps/1000000, na.rm = TRUE)
u30<-mean(traza30$Total.Incoming.bps/1000000, na.rm = TRUE)
````

Calculando las varianzas de cada traza

````{r}
for (i in 1:30) {
  cat("V",i,"<-","var(traza",i,"$Total.Incoming.bps/1000000, na.rm = TRUE)","\n",sep = "")
}
````

````{r echo=FALSE}
V1<-var(traza1$Total.Incoming.bps/1000000, na.rm = TRUE)
V2<-var(traza2$Total.Incoming.bps/1000000, na.rm = TRUE)
V3<-var(traza3$Total.Incoming.bps/1000000, na.rm = TRUE)
V4<-var(traza4$Total.Incoming.bps/1000000, na.rm = TRUE)
V5<-var(traza5$Total.Incoming.bps/1000000, na.rm = TRUE)
V6<-var(traza6$Total.Incoming.bps/1000000, na.rm = TRUE)
V7<-var(traza7$Total.Incoming.bps/1000000, na.rm = TRUE)
V8<-var(traza8$Total.Incoming.bps/1000000, na.rm = TRUE)
V9<-var(traza9$Total.Incoming.bps/1000000, na.rm = TRUE)
V10<-var(traza10$Total.Incoming.bps/1000000, na.rm = TRUE)
V11<-var(traza11$Total.Incoming.bps/1000000, na.rm = TRUE)
V12<-var(traza12$Total.Incoming.bps/1000000, na.rm = TRUE)
V13<-var(traza13$Total.Incoming.bps/1000000, na.rm = TRUE)
V14<-var(traza14$Total.Incoming.bps/1000000, na.rm = TRUE)
V15<-var(traza15$Total.Incoming.bps/1000000, na.rm = TRUE)
V16<-var(traza16$Total.Incoming.bps/1000000, na.rm = TRUE)
V17<-var(traza17$Total.Incoming.bps/1000000, na.rm = TRUE)
V18<-var(traza18$Total.Incoming.bps/1000000, na.rm = TRUE)
V19<-var(traza19$Total.Incoming.bps/1000000, na.rm = TRUE)
V20<-var(traza20$Total.Incoming.bps/1000000, na.rm = TRUE)
V21<-var(traza21$Total.Incoming.bps/1000000, na.rm = TRUE)
V22<-var(traza22$Total.Incoming.bps/1000000, na.rm = TRUE)
V23<-var(traza23$Total.Incoming.bps/1000000, na.rm = TRUE)
V24<-var(traza24$Total.Incoming.bps/1000000, na.rm = TRUE)
V25<-var(traza25$Total.Incoming.bps/1000000, na.rm = TRUE)
V26<-var(traza26$Total.Incoming.bps/1000000, na.rm = TRUE)
V27<-var(traza27$Total.Incoming.bps/1000000, na.rm = TRUE)
V28<-var(traza28$Total.Incoming.bps/1000000, na.rm = TRUE)
V29<-var(traza29$Total.Incoming.bps/1000000, na.rm = TRUE)
V30<-var(traza30$Total.Incoming.bps/1000000, na.rm = TRUE)
`````

Los datos de las trazas son:

````{r}
for (i in 1:30) {
  cat(i,"u",sep=",")
  }
for (i in 1:30) {
  cat(i,"V",sep=",")
  }  
  
u<-round(c(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,u23,u24,u25,u26,u27,u28,u29,u30),2)
v<-round(c(V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30),2)
 
tabla<-data.frame("Taza Arribo"=u,"Varianza Arribo"=v)
tabla
````

calculando los parámetros temporal y espacial de cada traza

````{r}
B<-0.150 

t<-round((B/(C-u))*(H/(1-H)),2)      #time parameter (us)
s<-round((B+(C+u)*t)/(v*t^(2*H)),2) #space parameter (bitss^-1)

#t<-log10(seq(length=100, from=1, to=200))    #time parameter (us)
#s<-log10(seq(length=100, from=1, to=5)) #space parameter (bits^-1)
````

Por lo tanto el ancho de banda efectivo para cada traza es:

````{r}
BWE<-round(u+(((s*v)/2)*(t^(2*H-1))),2)
BWE

datos<-data.frame("Taza_Arribo"=u,"Varianza_Arribo"=v,"time"=t,"space"=s,BWE)
datos
````

El ancho de banda efectivo promedio para la fuente de datos es:

````{r}
BWEmean<-round(mean(BWE),2)
BWEmean
````


El intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:

`````{r}
n<<-30
sd<-sqrt((1/(n-1)*(sum((BWE-BWEmean)^2))))

normalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),2)
normalci
````



#Caracterización fuente de video

Preparando los datos

````{r}
data_VoD<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/VoD/Subscribers_detail.csv",
               header=TRUE,sep=";",na.strings="NA",dec=",")

````


Aplicando modelo ON-OFF

````{r}
Pon<-data_VoD$Pon    #Propabilidad de estado ON
Poff<-data_VoD$Poff  #Propabilidad de estado OFF

h<-7.5 #Mbps tasa pico

Pon<-mean(Pon)
Poff<-mean(Poff)

space<-seq(length=50, from=0.5, to=55)
s<-(space)
BWE_onoff<-(1/s)*log10(Poff+(exp((h*s))*Pon))   
plot(BWE_onoff,s)
````

De lo anterior se observa que s tiene un conportamiento asintótico, para lo cual considera un valor máximo de s antes de volverse indeterminado en 45

````{r}
Pon<-data_VoD$Pon    #Propabilidad de estado ON
Poff<-data_VoD$Poff  #Propabilidad de estado OFF

s<-45
BWE_onoff<-round((1/s)*log10(Poff+(exp((h*s))*Pon)),3)  
BWE_onoff
````

El ancho de banda efectivo promedio para la fuente de datos es:

````{r}
BWEmean<-round(mean(BWE_onoff),3)
BWEmean
````


El intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:

`````{r}
n<<-30 #Cantidad de trazas muestreadas
sd<-sqrt((1/(n-1)*(sum((BWE_onoff-BWEmean)^2))))

normalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),3)
normalci
````


#Caracterización fuente de voz IP

Preparando los datos

````{r}
data_VoIP<-read.csv("C:/Users/NataliaA/Documents/Maestria/Tráfico L3/VoIP/Consumo_Voip.csv",
               header=TRUE,sep=";",na.strings="NA",dec=",")

````


Aplicando modelo ON-OFF

````{r}
Pon<-data_VoIP$Pon    #Propabilidad de estado ON
Poff<-data_VoIP$Poff  #Propabilidad de estado OFF

h<-24 #Kbps tasa pico BW sobre IP con G729

Pon<-mean(Pon)
Poff<-mean(Poff)

space<-seq(length=50, from=0.5, to=35)
s<-(space)
BWE_onoff<-(1/s)*log10(Poff+(exp((h*s))*Pon))   
plot(BWE_onoff,s)
````

De lo anterior se observa que s tiene un conportamiento asintótico

````{r}
Pon<-data_VoIP$Pon    #Propabilidad de estado ON
Poff<-data_VoIP$Poff  #Propabilidad de estado OFF

s<-29   #Antes de que el BWE se vuelva indeterminado
BWE_onoff<-round((1/s)*log10(Poff+(exp((h*s))*Pon)),3)  
BWE_onoff #[Kbps]
````

El ancho de banda efectivo promedio para la fuente de datos es:

````{r}
BWEmean<-round(mean(BWE_onoff),3)
BWEmean #[Kbps]
````


El intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:

`````{r}
n<<-30 #Cantidad de trazas muestreadas
sd<-sqrt((1/(n-1)*(sum((BWE_onoff-BWEmean)^2))))

normalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),3)
normalci  #[Kbps]
````
