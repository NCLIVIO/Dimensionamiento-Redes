{
    "contents" : "---\ntitle: \"Caracterización de Tráfico Ethernet\"\nauthor: \"Natalia Clivio\"\ndate: \"2015\"\noutput: pdf_document\n---\nEl ancho de banda efectivo es una medida usada en el dimensionamiento y planeamiento de redes de comunicaciones modernas. \n\nEl objetivo de este análisis, es estimar el ancho de banda efectivo para distintos flujos de tráfico generados y la traza conocida de Bellcore.\n\nEn cuanto a la estimación del ancho de banda efectivo hay dos enfoques, el paramétrico y el no paramétrico. En el enfoque paramétrico se asume un modelo de la fuente de tráfico y a partir de las trazas se estima un conjunto de parámetros de dicho modelo. De esa forma se obtiene un estimador del ancho de banda efectivo y además es posible calcular su intervalo de confianza.\n\nEn el enfoque no paramétrico, no se asume un modelo específico del tráfico y se procura construir un estimador del ancho de banda efectivo calculando el valor esperado que aparece en la función generatriz de momentos a través de promedios temporales en la traza.\n\nInicialmente se analizarán modelos sencillos como proceso de Poisson y movimiento browniano, seguido de Fluido de Markov ON/OFF, movimiento fraccional browniano y modelo de FARIMA. Estos modelos presentan una variadad de características observadas en muchas formas en el tráfico real.\n\n##Traza 1\n####Flujo con Movimiento Browniano\nCalculando en ancho de banda efectivo para un flujo con movimiento browniano.\nEsta traza tiene una longitud de 512 con los siguientes prámetros:\n\nTaza promedio de arribo $\\hat{\\mu} = 50.83$\nVarianza de la taza de arribo $\\hat{\\theta^2} = 30.18$\n\nEl flujo tiene una taza de servicio de C=52, un buffer de tamaño B=5.\n\nCalculando el punto crítico $\\alpha(s,t)$\n\n````{r}\nC<-52\nB<-5\nl<-50.83\nvar<-30.18\nu<-l\n\ns<-(2*(C-u))/var\nt<-B/(C-u)\n\nBw_MB<-u+((s*var)/2)\nBw_MB\n\n````\n\n\n##Traza 2: Fuentes de Video\n###Fuente de fluido ON/OFF\nConsiderando un flujo de longitud 512, con parámetros:\n\nProbabilidad del estado 1 al 2 $\\mu = 0.4$\nProbabilidad del estado 2 al 1 $\\lambda = 0.3$\nTrabajo que genera el estado 1 $h=3.0$\n\nEl flujo tiene una taza de servicio de C=2, un buffer de tamaño B=15.\n\nCalculando el punto crítico $\\alpha(s,t)$, aplicando la ecuación de optimización inf sup.\n\n````{r}\nC<-2\nB<-15\nl<-0.3\nu<-0.4\nh<-3.0\npi1<-l/(l+u)\npi2<-u/(l+u)\nt<-2\n\nI<-inf(ti)\nsup(S)S*(B+(C*ti))-(ti*log10(((exp(S*h))*pi1)+pi2))\n#s<-0.7 ti<-28\ns<-(2*(C-u))/t2 \n\n\ns*(B+(C*ti))-(ti*log10(((exp(s*h))*pi1)+pi2))\n\nBw_F<-(1/s)*log10(((exp(s*h))*pi1)+pi2)\nBw_F\n\nf <- function(S,t1) S*(B+(C*t1))-(t1*log10(((exp(S*h))*pi1)+pi2))\nspace<-seq(length=30, from=0.1, to=10)\ntime<-seq(length=30, from=0.1, to=30) #ms\nS<-space\nt1<-time\n\nz <- outer(S,t1,f)\npersp(S,t1,z,phi=10,theta=-40,col=\"yellow\",shade=.00000001,ticktype=\"detailed\")\n\n\n\n\noptim( c(0,0), f )$par\n\nf <- function(x) (1-x[1])^2 + 100*(x[2]-x[1]^2)^2\noptim( c(0,0), f )$par\noptim( c(0,0), f )$value\n\nf <- function(x1,y1) (1-x1)^2 + 100*(y1 - x1^2)^2\nx <- seq(-2,2,by=.15)\ny <- seq(-1,3,by=.15)\nz <- outer(x,y,f)\npersp(x,y,z,phi=45,theta=-45,col=\"yellow\",shade=.00000001,ticktype=\"detailed\")\n\n\nBw_F<-(1/s)*log10(((exp(s*h))*pi1)+pi2)\n\n#Trazas de largo T muestras, con la siguiente matriz Q\n#Estado 0 off\n#Estado h on\nspace<-seq(length=30, from=0.1, to=100)\ntime<-seq(length=30, from=0.1, to=40) #ms\ns<-space\nt<-time\n\nl<-0.024  #Cantidad de transiciones del estado 0 al h por unidad de t\nu<-0.076  #Cantidad de transiciones que salen de 0 por unidad de t\nh<-0.01\n\n#Distribución invariante es un vector de probabilidad pi tal que piQ=0, entonces:\npi1<-l/(l+u)\npi2<-u/(l+u) \npi<-matrix(c(pi1,0,pi2,0),2,2)\nQ<-matrix(c(-l,u,l,-u),2,2)\nH<-matrix(c(0,0,0,h),2,2)\nV<-matrix(1,2,2)\n\nBw_OnOff<-(1/(s*t))*log10(pi*exp((Q+H)*1)*V)\np<-log10(pi*exp((Q+H)*1)*V)\n\n\nz<-outer(s,t,Bw_OnOff)     # La función outer evalua la función Bw en cada punto(si,tj)\npersp(s,t,z)                    # Un gráfico en perspectiva\npersp(s,t,z,theta=40,phi=0,col = \"lightblue\", main=\"Ancho de Banda Efectivo\",ticktype = \"detailed\",xlab=\"s\",ylab=\"time (ms)\",zlab=\"(s,t)\")  \n\n\n\n\nspace<-seq(length=30, from=0.1, to=1)\ntime<-seq(length=30, from=0.1, to=2) #ms\ns<-space\nt<-time\nm<-1\nh<-3\n\n# Definimos la función que dibujaremos\nBw<-function(s,t) {(1/(s*t))*log10(1+((m/h)*(exp(s*h*t)-1)))}   \nz<-outer(s,t,Bw)     # La función outer evalua la función Bw en cada punto(si,tj)\npersp(s,t,z)                    # Un gráfico en perspectiva\npersp(s,t,z,theta=40,phi=0,col = \"lightblue\", main=\"Ancho de Banda Efectivo\",ticktype = \"detailed\",xlab=\"s\",ylab=\"time (ms)\",zlab=\"(s,t)\")  \n\n````\n\n\n##Traza 3\n###Movimiento fraccional browniano\nEsta traza corresponde a un modelo con dependencia de rango largo, numerosos estudios sugieren que este es el comportamiento de las redes modernas de tráfico. A continuación se calcula el ancho de banda efectivo de un movimiento fraccional browniano con parámetro Hurst H=0.75, y los siguientes parámetros:\n\nTaza promedio de arribo $\\hat{\\mu} = 35.09$\nVarianza de la taza de arribo $\\hat{\\theta^2} = 25.53$\n\nEl flujo tiene una taza de servicio de C=37, un buffer de tamaño B=5.\n\nCalculando el punto crítico $\\alpha(s,t)$\n\n````{r}\n#Generate a time series of fractional Brownian motion.\nfbm(hurst = 0.7, n = 100)\nfbm()\nplot(fbm())\nd <- fbm(hurst=0.81, n=1000000)\nplot(d)\n\n\nC<-37\nB<-5\nu<-35.09\nt2<-25.53\nH<-0.75\n\ns<-(B+(C+u)*t)/(t2*t^(2*H)) #0.0355\nt<-(B/(C-u))*(H/(1-H))      #8\n\nBw_MFB<-u+(((s*t2)/2)*(t^(2*H-1)))\n````\n\n\n\n##Traza 4:Proceso de Cola Pesada\n###$\\alpha$-Stable Farima\nEste modelo se usa en el estudio de las redes modernas de tráfico,con tendencia a incrementos con colas pesadas y procesos de dependencia de rango largo.\n\nTaza promedio de arribo $\\hat{\\mu} = 24.968$\nVarianza de la taza de arribo $\\hat{\\theta^2} = 4.058$\n\nEl flujo tiene una taza de servicio de C=25, un buffer de tamaño B=4.\n\nCalculando el punto crítico $\\alpha(s,t)$\n\n````{r}\nC<-25\nB<-4\nu<-24.968\nt2<-4.058\n\ns<-(2*(C-u))/t2 #0.0159\nt<-B/(C-u)      #124\n\n````\n\n\n##Traza 5\n### Traza de tráfico Real Bellcore\n\nEsta traza de tráfico de BELLCORE labs, esta traza contiene 1000000 de paquetes y se encuentran en dos columnas, en formato ASCII, veinte bytes por línea. La primera línea muestra el tiempo en segundos desde el comienzo de la traza. La segunda columna muestra el tamaño del paquete en bytes, incluyendo parte del encabezado y el código de redundancia cíclica (CRC), tener encuenta que que con el protocolo Ethernet los paquetes poseen un tamaño mínimo de 64 bytes y un máximo de 1.518 bytes.\n\nLa traza Bc-pAug89 comienza a las 11:25 el 29 de agosto de 1989, capturó datos alrededor de 3.142,82 s (aproximadamente 1.000.000 paquetes fueron capturados).\n\n\n```{r echo=FALSE, fig.show='hide'}\npackets<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/Bellcore/BC-pAug89.csv\",\n                  header=TRUE,sep=\";\",na.strings=\"NA\",dec=\".\")\n\ndataset<-data.frame(Seconds=packets$Seconds,Bytes=packets$Bytes)\n\nvector<-dataset$Seconds\nlast=tail(vector,n=1)\nunit_time=0.5\nstep=last/unit_time\nh_data<-hist(vector,breaks=step)              \n````\n\n````{r echo=FALSE}\nbelly<-c(0,h_data$counts)\nbellx<-h_data$breaks\nplot(bellx,belly,type=\"l\",xlab=\"time (s)\",ylab=\"Packets\",main=\"Bellcore trace\", ylim=c(0,500))\n````\n\n\nCalculando el ancho de banda efectivo, considerando los parámetros:\n\nTaza promedio de arribo $\\hat{\\mu} = 1.591$\nVarianza de la taza de arribo $\\hat{\\theta^2} = 4.169$\n\nEl flujo tiene una taza de servicio de C=2.9, un buffer de tamaño B=0.3 (300 Bytes).\n\nCalculando el punto crítico $\\alpha(s,t)$\n\n````{r}\nC<-2.9\nB<-0.3\nu<-1.591\nt2<-4.169\n\ns<-(2*(C-u))/t2\nt<-B/(C-u)\n\n````\n\n````{r}\n#De 512 datos X=255.5\nlam<-1.591\nlam<-2.498\nvar<-4.169\nn<-512\nint<-0.95\nz<-1.96\nz-0.231\n\nintl<-lam-((var/sqrt(n))*z)\ninth<-lam+((var/sqrt(n))*z)\n````\n\nMoving Blocks bootstrap estimator\n\n`````{r}\nx<-c(13, 11.5, 13.5, 14, 10, 9, 15, 14.5, 8, 9.5, 9, 10)\ny<-c(0.707, 1.0,0.707, 0.0, -0.707, -1.0, -0.707, 0.0, 0.707, 1.0, 0.707, 0.0, -0.707, -1.0, -0.707, 0.0)\n\nsuy<-c(0.577,0.985, 0.816, 0.169, -0.577, -0.985, -0.816, -0.169, 0.577, 0.985,\n       0.816, 0.169, -0.577, -0.985,-0.816, -0.169)\n\nsurr <- surrogate(beamchaos, method=\"ce\")\n## print the result\nprint(surr)\nplot(surr, type=\"time\")\nplot(surr, type=\"sdf\")\nplot(surr, type=\"lag\")\nplot(surr, type=\"pdf\")\n## create comparison time history\nplot(surr, show=\"both\", type=\"time\")\nsummary(surr)\n\ns<-surrogate(x, method=\"ce\")\n\nsy<-surrogate(y, method=\"phase\")\nsummary(sy)\nplot(sy, type=\"pdf\")\n\ndata_Bell<-head(bellx,1000)\nsurr <- surrogate(data_Bell, method=\"phase\")\nsummary(surr)\nplot(surr, type=\"time\")\nplot(surr, type=\"sdf\")\nplot(surr, type=\"lag\")\nplot(surr, type=\"pdf\")\nplot(surr, show=\"both\", type=\"time\")\n\n\n\nlam<-41.5\nvar<-0.3\nn<-10\nint<-0.95\nz<-1.96\n\nintl<-lam-((var/sqrt(n))*z)\ninth<-lam+((var/sqrt(n))*z)\n\n#BM\nlam<-50.83\nvar<-30.18\nn<-512\nint<-0.95\nz<-1.96\nintl<-lam-((var/sqrt(n))*z)\ninth<-lam+((var/sqrt(n))*z)\nintl\ninth\n\n````\n\nParte 2 MFB\nTeniendo en cuenta las características autosimilares de esta traza de tráfico y que siga un modelo de movimiento fraccional browniano,  entonces se puede suponer para el modelo una llegada de los datos en intervalos de tiempo t dada por:\n\n$$X[\\tau,\\tau+t]=\\lambda t+Z(t)$$\n \ndonde Z(t) corresponde al movimiento fraccional browniano con Var[Z(t)]=o^2*t^(2*H) para un parámetro de HURTS *H* entre 0 y 1, entonces: (Kelly(1996))\n\n$$\\alpha(s,t)=\\lambda + \\frac{\\theta^2 t^{(2H-1)}}{2}s$$\n\nA continuación se muestra la superficie del ancho de banda efectivo $\\alpha(s,t)$ de un modelo con movimiento fraccional browniano, y con los parámetros:\n\n```{r}\no<-89.668   # theta (bytes per second)\nH<-0.81     # Hurts parameter, obtained by log variance time plot of the data\nl<-138.185  # lambda (bytes per second)\nt<-(seq(length=100, from=0.0001, to=10))    #time parameter (ms)\ns<-(seq(length=100, from=0.00001, to=0.01)) #space parameter (bytes^-1)\n\n````\n\nLos ejes tienen escala logarítmica (base 10) con s en unidades de $bytes^-1$, t en segundos y $\\alpha(s,t)$ en bytes por segundo.\n\n````{r}\nBw<-function(s,t) {log10(l+((((o^2)*(t^((2*H)-1)))/2)*s))}   \nz<-outer(t,s,Bw) # La función outer evalua la función Bw en cada punto(si,tj)\n\npersp((t),(s),(z),theta=20,phi=-0,col = \"lightblue\", main=\"Ancho de Banda Efectivo\",\n      ticktype =\"detailed\",xlab=\"t (ms)\",ylab=\"s\",zlab=\"(s,t)\")  \n````\n\n\n````{r echo=FALSE}\nalpha<-log10(l+((((o^2)*(t^((2*H)-1)))/2)*s))\n````\n\nConsiderando el intervalo de confiaza para calcular el ancho de banda para un flujo con movimiento browniano, determinado por:\n\n$$[\\mu_l + \\frac{(s\\theta_l^2)}{2},\\mu_u + \\frac{(s\\theta_u^2)}{2}]$$\n\nEl intervalo de confianza será:\n````{r}\nul<-50.33\nvarl<-30\nuh<-50.83\nvarh<-30.18\nLB<-ul+((s*varl)/2)\nLB\nHB<-uh+((s*varh)/2)\nHB\n\n````\n\n\n````{r}\nlibrary(somebm)\nbm(x0 = 0, t0 = 0, t = 1, n = 512) #Generate a time series of Brownian motion.\n\nbm()\nplot(bm())\na <- bm(x0=1, t0=1, t=500, n=1000)\nplot(a)\nsummary(a)\n\n````\n\n",
    "created" : 1437226849896.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "446070287",
    "id" : "C9AE1330",
    "lastKnownWriteTime" : 1440340672,
    "path" : "~/GitHub/Dimensionamiento-Redes/Actividad 3/Trafico_Ethernet.Rmd",
    "project_path" : "Trafico_Ethernet.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}