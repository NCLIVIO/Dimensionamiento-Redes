{
    "contents" : "---\ntitle: \"Fuentes de Tráfico\"\nauthor: \"Natalia Clivio\"\ndate: \"2016\"\noutput: word_document\n---\n\n\n#Caracterización fuente de datos\n\n````{r echo=FALSE}\n#Incoming=Downstream\n\ntraza1<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/Subscribers_SA/Bitrate+for+CM_ 5039554F580D.csv\",\n                header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza2<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/Subscribers_SA/Bitrate+for+CM_ 5039556D04A7.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza3<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/Subscribers_SA/Bitrate+for+CM_ 5039556D0074.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza4<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/Subscribers_SA/Bitrate+for+CM_ 50395547B04E .csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza5<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_001ADE98D58A.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza6<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_001BD7A7BDE4.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza7<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_001BD710FADC.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza8<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_001CEA64E4AC.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza9<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_7CBFB1B96514.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\n\ntraza10<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_0014E8295DC2.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza11<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_0022CE977359.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza12<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_0023BED75BEA.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza13<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_34BDFA8A9080.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza14<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_34BDFA8BB6A9.csv\",\n                 header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza15<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_34BDFA8C66F3.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza16<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_94CCB91B032C.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza17<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_145BD1FD79DD.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza18<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_00159A4228E8.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza19<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_00159A6160B0.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\n\ntraza20<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_00223AEEC591.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza21<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_386BBB15666A.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza22<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_088039A22100.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza23<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_5039554DEF9A.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza24<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_5039556B3A1E.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza25<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_5039556D0074.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza26<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_50395547CC55.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza27<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_503955444D9B.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza28<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_503955693D40.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza29<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_5039554421B8.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\ntraza30<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/TráficoL3/Subscribers_SA/Bitrate+for+CM_E48399206392.csv\",\n                  header=TRUE,sep=\",\",na.strings=\"NA\",dec=\".\")\n\n````\n\n\nUna vez, cargadas las trazas de cada suscriptor se calculan los parámetros de cada traza. Estos parámetros son:\nCapacidad del canal **C** que esta determinada por la velocidad contratada por el adonado, para este caso son 6 Mbps.\n***Tamaño de buffer **B**\nTaza promedio de arribo $\\hat{\\mu}$\nVarianza de la taza de arribo $\\hat{\\theta^2}$\nparámetro Hurst **H**\nParámetro temporal **t**\nParámetro espacial **s**\n\n````{r}\n#Capacidad mámima Kbps\n\nCmax<-6000  #Capacidad mámima Kbps\n\nDS<-data.frame(Time=traza1$Time.Description,DS=traza1$CM.DS.KBPS)\nsetDS<-na.omit(DS)\nplot(setDS$DS,type=\"l\",ylab=\"Kbps\",xlab=\"Tiempo\",main=\"Tráfico Fuente Internet 6M\",sub=\"Fig1. Ejemplo de una fuente de Internet\")\nabline(h=mean(DS$DS,na.rm = TRUE),col=\"pink\",lty=3)\nabline(h=max(DS$DS,na.rm = TRUE),col=\"violet\",lty=3)\n````\n\nCapacidad de cada fuente\n\n````{r}\nc1<-max(DS1)\nc2<-max(DS2)\nc3<-max(DS3)\nc4<-max(DS4)\nc5<-max(DS5)\nc6<-max(DS6)\nc7<-max(DS7)\nc8<-max(DS8)\nc9<-max(DS9)\nc10<-max(DS10)\nc11<-max(DS11)\nc12<-max(DS12)\nc13<-max(DS13)\nc14<-max(DS14)\nc15<-max(DS15)\nc16<-max(DS16)\nc17<-max(DS17)\nc18<-max(DS18)\nc19<-max(DS19)\nc20<-max(DS20)\nc21<-max(DS21)\nc22<-max(DS22)\nc23<-max(DS23)\nc24<-max(DS24)\nc25<-max(DS25)\nc26<-max(DS26)\nc27<-max(DS27)\nc28<-max(DS28)\nc29<-max(DS29)\nc30<-max(DS30)\n\nC<-c(c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20,c21,c22,c23,c24,c25,c26,c27,c28,c29,c30)\n````\n\nCálculo del parámetro HURST\n````{r}\ndata<-setDS$DS\nh<-as.ts(data)\nRS<-rsFit(h, levels = 50, minnpts = 3, cut.off = 10^c(0.7, 2.5),\n          doplot = TRUE, trace = FALSE, title = NULL, description = NULL)\nH<-data.frame(RS@hurst)$H[1]\nRS\n````\n\nSe calcula para cada traza\n````{r}\nfor (i in 1:30) {\n  cat(\"DS\",i,\"<-\",\"na.omit(traza\",i,\"$CM.DS.KBPS, na.rm = TRUE)\",\"\\n\",sep = \"\")\n}\n\nfor (i in 1:30) {\n  cat(\"h\",i,\"<-\",\"as.ts(DS\",i,\")\",\"\\n\",sep = \"\")\n}\n\nfor (i in 1:30) {\n  cat(\"RS\",i,\"<-\",\"rsFit(h\",i,\",levels = 50, minnpts = 3, cut.off = 10^c(0.7, 2.5),doplot = TRUE, trace = FALSE, title = NULL, description = NULL)\",\"\\n\",sep = \"\")\n}\n\nfor (i in 1:30) {\n  cat(\"H\",i,\"<-\",\"data.frame(RS\",i,\"@hurst)$H\",\"[1]\",\"\\n\",sep = \"\")\n}\n\nH<-c(H1=0.82,H2=0.82,H3=0.82,H4=0.82,H5=0.82,H6=0.82,H7=0.82,H8=0.82,H9=0.82,H10=0.82,\n     H11=0.82,H12=0.82,H13=0.82,H14=0.82,H15=0.82,H16=0.82,H17=0.82,H18=0.82,H19=0.82,\n     H20=0.82,H21=0.82,H22=0.82,H23=0.82,H24=0.82,H25=0.82,H26=0.82,H27=0.82,H28=0.82,\n     H29=0.82,H30=0.82)\n````\n\n\nCalculando la tasa promedio de arribo de cada traza:\n````{r}\nfor (i in 1:30) {\n  cat(\"u\",i,\"<-\",\"mean(traza\",i,\"$CM.DS.KBPS, na.rm = TRUE)\",\"\\n\",sep = \"\")\n}\n````\n\n\n````{r echo=FALSE}\nu1<-mean(traza1$CM.DS.KBPS, na.rm = TRUE)\nu2<-mean(traza2$CM.DS.KBPS, na.rm = TRUE)\nu3<-mean(traza3$CM.DS.KBPS, na.rm = TRUE)\nu4<-mean(traza4$CM.DS.KBPS, na.rm = TRUE)\nu5<-mean(traza5$CM.DS.KBPS, na.rm = TRUE)\nu6<-mean(traza6$CM.DS.KBPS, na.rm = TRUE)\nu7<-mean(traza7$CM.DS.KBPS, na.rm = TRUE)\nu8<-mean(traza8$CM.DS.KBPS, na.rm = TRUE)\nu9<-mean(traza9$CM.DS.KBPS, na.rm = TRUE)\nu10<-mean(traza10$CM.DS.KBPS, na.rm = TRUE)\nu11<-mean(traza11$CM.DS.KBPS, na.rm = TRUE)\nu12<-mean(traza12$CM.DS.KBPS, na.rm = TRUE)\nu13<-mean(traza13$CM.DS.KBPS, na.rm = TRUE)\nu14<-mean(traza14$CM.DS.KBPS, na.rm = TRUE)\nu15<-mean(traza15$CM.DS.KBPS, na.rm = TRUE)\nu16<-mean(traza16$CM.DS.KBPS, na.rm = TRUE)\nu17<-mean(traza17$CM.DS.KBPS, na.rm = TRUE)\nu18<-mean(traza18$CM.DS.KBPS, na.rm = TRUE)\nu19<-mean(traza19$CM.DS.KBPS, na.rm = TRUE)\nu20<-mean(traza20$CM.DS.KBPS, na.rm = TRUE)\nu21<-mean(traza21$CM.DS.KBPS, na.rm = TRUE)\nu22<-mean(traza22$CM.DS.KBPS, na.rm = TRUE)\nu23<-mean(traza23$CM.DS.KBPS, na.rm = TRUE)\nu24<-mean(traza24$CM.DS.KBPS, na.rm = TRUE)\nu25<-mean(traza25$CM.DS.KBPS, na.rm = TRUE)\nu26<-mean(traza26$CM.DS.KBPS, na.rm = TRUE)\nu27<-mean(traza27$CM.DS.KBPS, na.rm = TRUE)\nu28<-mean(traza28$CM.DS.KBPS, na.rm = TRUE)\nu29<-mean(traza29$CM.DS.KBPS, na.rm = TRUE)\nu30<-mean(traza30$CM.DS.KBPS, na.rm = TRUE)\n````\n\nCalculando las varianzas de cada traza\n\n````{r}\nfor (i in 1:30) {\n  cat(\"V\",i,\"<-\",\"var(traza\",i,\"$CM.DS.KBPS, na.rm = TRUE)\",\"\\n\",sep = \"\")\n}\n````\n\n````{r echo=FALSE}\nV1<-var(traza1$CM.DS.KBPS, na.rm = TRUE)\nV2<-var(traza2$CM.DS.KBPS, na.rm = TRUE)\nV3<-var(traza3$CM.DS.KBPS, na.rm = TRUE)\nV4<-var(traza4$CM.DS.KBPS, na.rm = TRUE)\nV5<-var(traza5$CM.DS.KBPS, na.rm = TRUE)\nV6<-var(traza6$CM.DS.KBPS, na.rm = TRUE)\nV7<-var(traza7$CM.DS.KBPS, na.rm = TRUE)\nV8<-var(traza8$CM.DS.KBPS, na.rm = TRUE)\nV9<-var(traza9$CM.DS.KBPS, na.rm = TRUE)\nV10<-var(traza10$CM.DS.KBPS, na.rm = TRUE)\nV11<-var(traza11$CM.DS.KBPS, na.rm = TRUE)\nV12<-var(traza12$CM.DS.KBPS, na.rm = TRUE)\nV13<-var(traza13$CM.DS.KBPS, na.rm = TRUE)\nV14<-var(traza14$CM.DS.KBPS, na.rm = TRUE)\nV15<-var(traza15$CM.DS.KBPS, na.rm = TRUE)\nV16<-var(traza16$CM.DS.KBPS, na.rm = TRUE)\nV17<-var(traza17$CM.DS.KBPS, na.rm = TRUE)\nV18<-var(traza18$CM.DS.KBPS, na.rm = TRUE)\nV19<-var(traza19$CM.DS.KBPS, na.rm = TRUE)\nV20<-var(traza20$CM.DS.KBPS, na.rm = TRUE)\nV21<-var(traza21$CM.DS.KBPS, na.rm = TRUE)\nV22<-var(traza22$CM.DS.KBPS, na.rm = TRUE)\nV23<-var(traza23$CM.DS.KBPS, na.rm = TRUE)\nV24<-var(traza24$CM.DS.KBPS, na.rm = TRUE)\nV25<-var(traza25$CM.DS.KBPS, na.rm = TRUE)\nV26<-var(traza26$CM.DS.KBPS, na.rm = TRUE)\nV27<-var(traza27$CM.DS.KBPS, na.rm = TRUE)\nV28<-var(traza28$CM.DS.KBPS, na.rm = TRUE)\nV29<-var(traza29$CM.DS.KBPS, na.rm = TRUE)\nV30<-var(traza30$CM.DS.KBPS, na.rm = TRUE)\n`````\n\nLos datos de las trazas son:\n\n````{r}\nfor (i in 1:30) {\n  cat(i,\"u\",sep=\",\")\n  }\nfor (i in 1:30) {\n  cat(i,\"V\",sep=\",\")\n  }  \n  \nu<-round(c(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,u23,u24,u25,u26,u27,u28,u29,u30),2)\nv<-round(c(V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30),2)\n \ntabla<-data.frame(\"Taza Arribo\"=u,\"Varianza Arribo\"=v)\ntabla\n````\n\nEliminando los valores \"NA\"\n\n````{r}\nDS1<-na.omit(traza1$CM.DS.KBPS, na.rm = TRUE)\nDS2<-na.omit(traza2$CM.DS.KBPS, na.rm = TRUE)\nDS3<-na.omit(traza3$CM.DS.KBPS, na.rm = TRUE)\nDS4<-na.omit(traza4$CM.DS.KBPS, na.rm = TRUE)\nDS5<-na.omit(traza5$CM.DS.KBPS, na.rm = TRUE)\nDS6<-na.omit(traza6$CM.DS.KBPS, na.rm = TRUE)\nDS7<-na.omit(traza7$CM.DS.KBPS, na.rm = TRUE)\nDS8<-na.omit(traza8$CM.DS.KBPS, na.rm = TRUE)\nDS9<-na.omit(traza9$CM.DS.KBPS, na.rm = TRUE)\nDS10<-na.omit(traza10$CM.DS.KBPS, na.rm = TRUE)\nDS11<-na.omit(traza11$CM.DS.KBPS, na.rm = TRUE)\nDS12<-na.omit(traza12$CM.DS.KBPS, na.rm = TRUE)\nDS13<-na.omit(traza13$CM.DS.KBPS, na.rm = TRUE)\nDS14<-na.omit(traza14$CM.DS.KBPS, na.rm = TRUE)\nDS15<-na.omit(traza15$CM.DS.KBPS, na.rm = TRUE)\nDS16<-na.omit(traza16$CM.DS.KBPS, na.rm = TRUE)\nDS17<-na.omit(traza17$CM.DS.KBPS, na.rm = TRUE)\nDS18<-na.omit(traza18$CM.DS.KBPS, na.rm = TRUE)\nDS19<-na.omit(traza19$CM.DS.KBPS, na.rm = TRUE)\nDS20<-na.omit(traza20$CM.DS.KBPS, na.rm = TRUE)\nDS21<-na.omit(traza21$CM.DS.KBPS, na.rm = TRUE)\nDS22<-na.omit(traza22$CM.DS.KBPS, na.rm = TRUE)\nDS23<-na.omit(traza23$CM.DS.KBPS, na.rm = TRUE)\nDS24<-na.omit(traza24$CM.DS.KBPS, na.rm = TRUE)\nDS25<-na.omit(traza25$CM.DS.KBPS, na.rm = TRUE)\nDS26<-na.omit(traza26$CM.DS.KBPS, na.rm = TRUE)\nDS27<-na.omit(traza27$CM.DS.KBPS, na.rm = TRUE)\nDS28<-na.omit(traza28$CM.DS.KBPS, na.rm = TRUE)\nDS29<-na.omit(traza29$CM.DS.KBPS, na.rm = TRUE)\nDS30<-na.omit(traza30$CM.DS.KBPS, na.rm = TRUE)\n````\n\n\ncalculando los parámetros temporal y espacial de cada traza\n\n````{r}\ntime<-log10(seq(length=100, from=1.1, to=100))    #time parameter (ms)\nt<-time\n\nfor (i in 1:30) {\n  cat(\"B\",i,\"<-(C\",i,\"-u\",i,\")*((t*(1-H))/H)\",\"\\n\",sep=\"\")\n  }\n\n#B<-(C-u)*((t*(1-H))/H) #ms\nB1<-(C1-u1)*((t*(1-H))/H)\nB2<-(C2-u2)*((t*(1-H))/H)\nB3<-(C3-u3)*((t*(1-H))/H)\nB4<-(C4-u4)*((t*(1-H))/H)\nB5<-(C5-u5)*((t*(1-H))/H)\nB6<-(C6-u6)*((t*(1-H))/H)\nB7<-(C7-u7)*((t*(1-H))/H)\nB8<-(C8-u8)*((t*(1-H))/H)\nB9<-(C9-u9)*((t*(1-H))/H)\nB10<-(C10-u10)*((t*(1-H))/H)\nB11<-(C11-u11)*((t*(1-H))/H)\nB12<-(C12-u12)*((t*(1-H))/H)\nB13<-(C13-u13)*((t*(1-H))/H)\nB14<-(C14-u14)*((t*(1-H))/H)\nB15<-(C15-u15)*((t*(1-H))/H)\nB16<-(C16-u16)*((t*(1-H))/H)\nB17<-(C17-u17)*((t*(1-H))/H)\nB18<-(C18-u18)*((t*(1-H))/H)\nB19<-(C19-u19)*((t*(1-H))/H)\nB20<-(C20-u20)*((t*(1-H))/H)\nB21<-(C21-u21)*((t*(1-H))/H)\nB22<-(C22-u22)*((t*(1-H))/H)\nB23<-(C23-u23)*((t*(1-H))/H)\nB24<-(C24-u24)*((t*(1-H))/H)\nB25<-(C25-u25)*((t*(1-H))/H)\nB26<-(C26-u26)*((t*(1-H))/H)\nB27<-(C27-u27)*((t*(1-H))/H)\nB28<-(C28-u28)*((t*(1-H))/H)\nB29<-(C29-u29)*((t*(1-H))/H)\nB30<-(C30-u30)*((t*(1-H))/H)\n\n#t<-round((B/(C-u))*(H/(1-H)),3)      #time parameter (us)\nfor (i in 1:30) {\n  cat(\"t\",i,\"<-round(B\",i,\"/(C\",i,\"-u\",i,\"))*(H/(1-H)),3)\",\"\\n\",sep=\"\")\n  }\n\nt1<-round(B1/(C1-u1))*(H/(1-H)),3)\nt2<-round(B2/(C2-u2))*(H/(1-H)),3)\nt3<-round(B3/(C3-u3))*(H/(1-H)),3)\nt4<-round(B4/(C4-u4))*(H/(1-H)),3)\nt5<-round(B5/(C5-u5))*(H/(1-H)),3)\nt6<-round(B6/(C6-u6))*(H/(1-H)),3)\nt7<-round(B7/(C7-u7))*(H/(1-H)),3)\nt8<-round(B8/(C8-u8))*(H/(1-H)),3)\nt9<-round(B9/(C9-u9))*(H/(1-H)),3)\nt10<-round(B10/(C10-u10))*(H/(1-H)),3)\nt11<-round(B11/(C11-u11))*(H/(1-H)),3)\nt12<-round(B12/(C12-u12))*(H/(1-H)),3)\nt13<-round(B13/(C13-u13))*(H/(1-H)),3)\nt14<-round(B14/(C14-u14))*(H/(1-H)),3)\nt15<-round(B15/(C15-u15))*(H/(1-H)),3)\nt16<-round(B16/(C16-u16))*(H/(1-H)),3)\nt17<-round(B17/(C17-u17))*(H/(1-H)),3)\nt18<-round(B18/(C18-u18))*(H/(1-H)),3)\nt19<-round(B19/(C19-u19))*(H/(1-H)),3)\nt20<-round(B20/(C20-u20))*(H/(1-H)),3)\nt21<-round(B21/(C21-u21))*(H/(1-H)),3)\nt22<-round(B22/(C22-u22))*(H/(1-H)),3)\nt23<-round(B23/(C23-u23))*(H/(1-H)),3)\nt24<-round(B24/(C24-u24))*(H/(1-H)),3)\nt25<-round(B25/(C25-u25))*(H/(1-H)),3)\nt26<-round(B26/(C26-u26))*(H/(1-H)),3)\nt27<-round(B27/(C27-u27))*(H/(1-H)),3)\nt28<-round(B28/(C28-u28))*(H/(1-H)),3)\nt29<-round(B29/(C29-u29))*(H/(1-H)),3)\nt30<-round(B30/(C30-u30))*(H/(1-H)),3)\n\n#s<-round((B+(C-u)*t)/(v*t^(2*H)),3)   #space parameter (bitss^-1)\nfor (i in 1:30) {\n  cat(\"s\",i,\"<-round(B\",i,\"+(C\",i,\"-u\",i,\")*t)/(v\",i,\"*t^(2*H)),3)\",\"\\n\",sep=\"\")\n  }\n\ns1<-round(B1+(C1-u1)*t)/(v1*t^(2*H)),3)\ns2<-round(B2+(C2-u2)*t)/(v2*t^(2*H)),3)\ns3<-round(B3+(C3-u3)*t)/(v3*t^(2*H)),3)\ns4<-round(B4+(C4-u4)*t)/(v4*t^(2*H)),3)\ns5<-round(B5+(C5-u5)*t)/(v5*t^(2*H)),3)\ns6<-round(B6+(C6-u6)*t)/(v6*t^(2*H)),3)\ns7<-round(B7+(C7-u7)*t)/(v7*t^(2*H)),3)\ns8<-round(B8+(C8-u8)*t)/(v8*t^(2*H)),3)\ns9<-round(B9+(C9-u9)*t)/(v9*t^(2*H)),3)\ns10<-round(B10+(C10-u10)*t)/(v10*t^(2*H)),3)\ns11<-round(B11+(C11-u11)*t)/(v11*t^(2*H)),3)\ns12<-round(B12+(C12-u12)*t)/(v12*t^(2*H)),3)\ns13<-round(B13+(C13-u13)*t)/(v13*t^(2*H)),3)\ns14<-round(B14+(C14-u14)*t)/(v14*t^(2*H)),3)\ns15<-round(B15+(C15-u15)*t)/(v15*t^(2*H)),3)\ns16<-round(B16+(C16-u16)*t)/(v16*t^(2*H)),3)\ns17<-round(B17+(C17-u17)*t)/(v17*t^(2*H)),3)\ns18<-round(B18+(C18-u18)*t)/(v18*t^(2*H)),3)\ns19<-round(B19+(C19-u19)*t)/(v19*t^(2*H)),3)\ns20<-round(B20+(C20-u20)*t)/(v20*t^(2*H)),3)\ns21<-round(B21+(C21-u21)*t)/(v21*t^(2*H)),3)\ns22<-round(B22+(C22-u22)*t)/(v22*t^(2*H)),3)\ns23<-round(B23+(C23-u23)*t)/(v23*t^(2*H)),3)\ns24<-round(B24+(C24-u24)*t)/(v24*t^(2*H)),3)\ns25<-round(B25+(C25-u25)*t)/(v25*t^(2*H)),3)\ns26<-round(B26+(C26-u26)*t)/(v26*t^(2*H)),3)\ns27<-round(B27+(C27-u27)*t)/(v27*t^(2*H)),3)\ns28<-round(B28+(C28-u28)*t)/(v28*t^(2*H)),3)\ns29<-round(B29+(C29-u29)*t)/(v29*t^(2*H)),3)\ns30<-round(B30+(C30-u30)*t)/(v30*t^(2*H)),3)\n\n\n#BWE<-round(u+(((s*v)/2)*(t^(2*H-1))),2)\nfor (i in 1:30) {\n  cat(\"BWE\",i,\"<-round(u\",i,\"+(((s\",i,\"*v\",i,\")/2)*(t^(2*H-1))),2)\",\"\\n\",sep=\"\")\n  }\n\nBWE1<-round(u1+(((s1*v1)/2)*(t^(2*H-1))),2)\nBWE2<-round(u2+(((s2*v2)/2)*(t^(2*H-1))),2)\nBWE3<-round(u3+(((s3*v3)/2)*(t^(2*H-1))),2)\nBWE4<-round(u4+(((s4*v4)/2)*(t^(2*H-1))),2)\nBWE5<-round(u5+(((s5*v5)/2)*(t^(2*H-1))),2)\nBWE6<-round(u6+(((s6*v6)/2)*(t^(2*H-1))),2)\nBWE7<-round(u7+(((s7*v7)/2)*(t^(2*H-1))),2)\nBWE8<-round(u8+(((s8*v8)/2)*(t^(2*H-1))),2)\nBWE9<-round(u9+(((s9*v9)/2)*(t^(2*H-1))),2)\nBWE10<-round(u10+(((s10*v10)/2)*(t^(2*H-1))),2)\nBWE11<-round(u11+(((s11*v11)/2)*(t^(2*H-1))),2)\nBWE12<-round(u12+(((s12*v12)/2)*(t^(2*H-1))),2)\nBWE13<-round(u13+(((s13*v13)/2)*(t^(2*H-1))),2)\nBWE14<-round(u14+(((s14*v14)/2)*(t^(2*H-1))),2)\nBWE15<-round(u15+(((s15*v15)/2)*(t^(2*H-1))),2)\nBWE16<-round(u16+(((s16*v16)/2)*(t^(2*H-1))),2)\nBWE17<-round(u17+(((s17*v17)/2)*(t^(2*H-1))),2)\nBWE18<-round(u18+(((s18*v18)/2)*(t^(2*H-1))),2)\nBWE19<-round(u19+(((s19*v19)/2)*(t^(2*H-1))),2)\nBWE20<-round(u20+(((s20*v20)/2)*(t^(2*H-1))),2)\nBWE21<-round(u21+(((s21*v21)/2)*(t^(2*H-1))),2)\nBWE22<-round(u22+(((s22*v22)/2)*(t^(2*H-1))),2)\nBWE23<-round(u23+(((s23*v23)/2)*(t^(2*H-1))),2)\nBWE24<-round(u24+(((s24*v24)/2)*(t^(2*H-1))),2)\nBWE25<-round(u25+(((s25*v25)/2)*(t^(2*H-1))),2)\nBWE26<-round(u26+(((s26*v26)/2)*(t^(2*H-1))),2)\nBWE27<-round(u27+(((s27*v27)/2)*(t^(2*H-1))),2)\nBWE28<-round(u28+(((s28*v28)/2)*(t^(2*H-1))),2)\nBWE29<-round(u29+(((s29*v29)/2)*(t^(2*H-1))),2)\nBWE30<-round(u30+(((s30*v30)/2)*(t^(2*H-1))),2)\n\n#Optimización para s\n#s.nls<-nls(BWE~u+(((s*v)/2)*(t^(2*H-1))),start = list(s=0.004))\n#space<-as.numeric(coef(s.nls))\n\nfor (i in 1:30) {\n  cat(\"s.nls\",i,\"<-nls(BWE\",i,\"~u\",i,\"+(((s\",i,\"*v\",i,\")/2)*(t^(2*H-1))),start = list(s=0.004))\",\"\\n\",sep=\"\")\n  }\n\ns.nls1<-nls(BWE1~u1+(((s1*v1)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls2<-nls(BWE2~u2+(((s2*v2)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls3<-nls(BWE3~u3+(((s3*v3)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls4<-nls(BWE4~u4+(((s4*v4)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls5<-nls(BWE5~u5+(((s5*v5)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls6<-nls(BWE6~u6+(((s6*v6)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls7<-nls(BWE7~u7+(((s7*v7)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls8<-nls(BWE8~u8+(((s8*v8)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls9<-nls(BWE9~u9+(((s9*v9)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls10<-nls(BWE10~u10+(((s10*v10)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls11<-nls(BWE11~u11+(((s11*v11)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls12<-nls(BWE12~u12+(((s12*v12)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls13<-nls(BWE13~u13+(((s13*v13)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls14<-nls(BWE14~u14+(((s14*v14)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls15<-nls(BWE15~u15+(((s15*v15)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls16<-nls(BWE16~u16+(((s16*v16)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls17<-nls(BWE17~u17+(((s17*v17)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls18<-nls(BWE18~u18+(((s18*v18)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls19<-nls(BWE19~u19+(((s19*v19)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls20<-nls(BWE20~u20+(((s20*v20)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls21<-nls(BWE21~u21+(((s21*v21)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls22<-nls(BWE22~u22+(((s22*v22)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls23<-nls(BWE23~u23+(((s23*v23)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls24<-nls(BWE24~u24+(((s24*v24)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls25<-nls(BWE25~u25+(((s25*v25)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls26<-nls(BWE26~u26+(((s26*v26)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls27<-nls(BWE27~u27+(((s27*v27)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls28<-nls(BWE28~u28+(((s28*v28)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls29<-nls(BWE29~u29+(((s29*v29)/2)*(t^(2*H-1))),start = list(s=0.004))\ns.nls30<-nls(BWE30~u30+(((s30*v30)/2)*(t^(2*H-1))),start = list(s=0.004))\n\n\n#Optimización para t\n#t.nls<-nls(BWE~u+(((s*v)/2)*(t^(2*H-1))),start = list(t=1))\n#time<-as.numeric(coef(t.nls))\n\nfor (i in 1:30) {\n  cat(\"s.nls\",i,\"<-nls(BWE\",i,\"~u\",i,\"+(((s\",i,\"*v\",i,\")/2)*(t^(2*H-1))),start = list(s=0.004))\",\"\\n\",sep=\"\")\n  }\n\n````\n\nCalculando el ancho de banda efectivo en el punto crítico (s,t), para cada traza se obtiene:\n\n````{r}\nt<-time\ns<-space\nBWE<-round(u+(((s*v)/2)*(t^(2*H-1))),2)\nBWE\n\nx<-u\nn<-BWE\nplot(setDS$DS,type=\"l\",ylab=\"Kbps\",xlab=\"Tiempo\",main=\"Tráfico Fuente Internet 6M\",ylim=c(0,6000))\nabline(h=n,col=\"red\")\nabline(h=x,col=\"blue\")\ngrid()\n\ndatos<-data.frame(\"Taza_Arribo\"=u,\"Varianza_Arribo\"=v,\"time\"=t,\"space\"=s,BWE)\ndatos\n````\n\nEl ancho de banda efectivo promedio para la fuente de datos es:\n\n````{r}\nBWEmean<-round(mean(BWE),2)\nBWEmean\n````\n\n\nEl intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:\n\n`````{r}\nn<<-30\nsd<-sqrt((1/(n-1)*(sum((BWE-BWEmean)^2))))\n\nnormalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),2)\nnormalci\n````\n\n\n\n#Caracterización fuente de video\n\nPreparando los datos\n\n````{r}\ndata_VoD<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/VoD/Subscribers_detail.csv\",\n               header=TRUE,sep=\";\",na.strings=\"NA\",dec=\",\")\n\n````\n\n\nAplicando modelo ON-OFF\n\n````{r}\nPon<-data_VoD$Pon    #Propabilidad de estado ON\nPoff<-data_VoD$Poff  #Propabilidad de estado OFF\n\nh<-7.5 #Mbps tasa pico\n\nPon<-mean(Pon)\nPoff<-mean(Poff)\n\nspace<-seq(length=50, from=0.5, to=55)\ns<-(space)\nBWE_onoff<-(1/s)*log10(Poff+(exp((h*s))*Pon))   \nplot(BWE_onoff,s)\n````\n\nDe lo anterior se observa que s tiene un conportamiento asintótico, para lo cual considera un valor máximo de s antes de volverse indeterminado en 45\n\n````{r}\nPon<-data_VoD$Pon    #Propabilidad de estado ON\nPoff<-data_VoD$Poff  #Propabilidad de estado OFF\n\ns<-45\nBWE_onoff<-round((1/s)*log10(Poff+(exp((h*s))*Pon)),3)  \nBWE_onoff\n````\n\nEl ancho de banda efectivo promedio para la fuente de datos es:\n\n````{r}\nBWEmean<-round(mean(BWE_onoff),3)\nBWEmean\n````\n\n\nEl intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:\n\n`````{r}\nn<<-30 #Cantidad de trazas muestreadas\nsd<-sqrt((1/(n-1)*(sum((BWE_onoff-BWEmean)^2))))\n\nnormalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),3)\nnormalci\n````\n\n\n#Caracterización fuente de voz IP\n\nPreparando los datos\n\n````{r}\ndata_VoIP<-read.csv(\"C:/Users/NataliaA/Documents/Maestria/Tráfico L3/VoIP/Consumo_Voip.csv\",\n               header=TRUE,sep=\";\",na.strings=\"NA\",dec=\",\")\n\n````\n\n\nAplicando modelo ON-OFF\n\n````{r}\nPon<-data_VoIP$Pon    #Propabilidad de estado ON\nPoff<-data_VoIP$Poff  #Propabilidad de estado OFF\n\nh<-24 #Kbps tasa pico BW sobre IP con G729\n\nPon<-mean(Pon)\nPoff<-mean(Poff)\n\nspace<-seq(length=50, from=0.5, to=35)\ns<-(space)\nBWE_onoff<-(1/s)*log10(Poff+(exp((h*s))*Pon))   \nplot(BWE_onoff,s)\n````\n\nDe lo anterior se observa que s tiene un conportamiento asintótico\n\n````{r}\nPon<-data_VoIP$Pon    #Propabilidad de estado ON\nPoff<-data_VoIP$Poff  #Propabilidad de estado OFF\n\ns<-29   #Antes de que el BWE se vuelva indeterminado\nBWE_onoff<-round((1/s)*log10(Poff+(exp((h*s))*Pon)),3)  \nBWE_onoff #[Kbps]\n````\n\nEl ancho de banda efectivo promedio para la fuente de datos es:\n\n````{r}\nBWEmean<-round(mean(BWE_onoff),3)\nBWEmean #[Kbps]\n````\n\n\nEl intervalo de confianza, calculando el percentil 95 para el ancho de banda efectivo promedio para una fuente de datos es:\n\n`````{r}\nn<<-30 #Cantidad de trazas muestreadas\nsd<-sqrt((1/(n-1)*(sum((BWE_onoff-BWEmean)^2))))\n\nnormalci<-round(BWEmean+c(-1,1)*qnorm(0.95)*sd/sqrt(n),3)\nnormalci  #[Kbps]\n````\n",
    "created" : 1478461677881.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "543716651",
    "id" : "FF3AFD29",
    "lastKnownWriteTime" : 1478747407,
    "path" : "~/GitHub/Dimensionamiento-Redes/Actividad 3/Fuentes de Tráfico.Rmd",
    "project_path" : "Fuentes de Tráfico.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_markdown"
}